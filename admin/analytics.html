<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Analytics | Eatrofit</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .card { margin-bottom: 1rem; }
    @media (max-width: 576px) {
      .container { padding: 0 5px; }
      h2 { font-size: 1.3rem; }
      .card-title { font-size: 1rem; }
      .btn { font-size: 0.9rem; padding: 0.5rem 1rem; }
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <h2 class="mb-3 text-center">Admin Analytics</h2>
    <div class="row g-3">
      <div class="col-6 col-md-3">
        <div class="card text-center shadow">
          <div class="card-body">
            <h6 class="card-title">Users</h6>
            <p class="card-text" id="userCount">--</p>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card text-center shadow">
          <div class="card-body">
            <h6 class="card-title">Workouts</h6>
            <p class="card-text" id="workoutCount">--</p>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card text-center shadow">
          <div class="card-body">
            <h6 class="card-title">Feedback</h6>
            <p class="card-text" id="feedbackCount">--</p>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card text-center shadow">
          <div class="card-body">
            <h6 class="card-title">Engagement</h6>
            <p class="card-text" id="engagement">--</p>
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-4">
      <div class="col-12">
        <div class="card shadow">
          <div class="card-body">
            <h6 class="card-title">User Growth</h6>
            <canvas id="userGrowthChart" height="120"></canvas>
          </div>
        </div>
      </div>
      <div class="col-12 mt-3">
        <div class="card shadow">
          <div class="card-body">
            <h6 class="card-title">Workout Trends</h6>
            <canvas id="workoutTrendChart" height="120"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Fetch analytics data
  fetch('../api/admin_analytics.php')
      .then(res => res.json())
      .then(data => {
        document.getElementById('userCount').textContent = data.userCount;
        document.getElementById('workoutCount').textContent = data.workoutCount;
        document.getElementById('feedbackCount').textContent = data.feedbackCount;
        document.getElementById('engagement').textContent = data.engagement;
        // User Growth Chart
        new Chart(document.getElementById('userGrowthChart'), {
          type: 'line',
          data: {
            labels: data.userGrowth.labels,
            datasets: [{
              label: 'Users',
              data: data.userGrowth.data,
              borderColor: '#0d6efd',
              backgroundColor: 'rgba(13,110,253,0.1)',
              fill: true
            }]
          },
          options: {responsive: true, plugins: {legend: {display: false}}}
        });
        // Workout Trend Chart
        new Chart(document.getElementById('workoutTrendChart'), {
          type: 'bar',
          data: {
            labels: data.workoutTrends.labels,
            datasets: [{
              label: 'Workouts',
              data: data.workoutTrends.data,
              backgroundColor: '#198754'
            }]
          },
          options: {responsive: true, plugins: {legend: {display: false}}}
        });
      });
  </script>
</body>
</html>
